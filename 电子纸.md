# 介绍

**电子纸（Electronic paper）**或**智能纸（intelligent paper）**是一种反射环境光的显示设备，模仿普通墨水在纸张上的显示效果（不像传统的平面显示器需要额外的能量来发出自己的光），这可能使它们阅读起来更舒适，而且提供比大多数发光显示器更宽的视角。截止2008年，市面上的电子显示器的对比度接近报纸，新开发的显示器略好一些。理想的电子纸显示器可以在阳光直射下阅读而不会图像褪色。



制作电子纸的技术包括

- [Gyricon](https://en.wikipedia.org/wiki/Gyricon)（球旋转）
- [electrophoretics](https://en.wikipedia.org/w/index.php?title=Electrophoretics&action=edit&redlink=1)（电泳）
- [electrowetting](https://en.wikipedia.org/wiki/Electrowetting)（电湿润）
- [interferometry](https://en.wikipedia.org/wiki/Interferometry)（干涉测量术）
- [plasmonics](https://en.wikipedia.org/wiki/Plasmonics)（等离子激元）

许多电子纸技术在没有电的情况下无限期地保持静态文本和图像。



几家公司正在同时开发电子纸和电子墨水，虽然每家公司使用的技术都提供了许多相同的特性，但每家公司都有自己独特的技术优势，所有的电子纸技术都面临着以下挑战

- 一种封装方法
- 一种填充封装的油墨或活性物质
- 激活墨水的电子材料

电子墨水可被应用于柔性或刚性材料。对于柔性显示器，底层需要一种薄而柔韧足以承受相当大磨损的材料（比如极薄的塑料）。如何将油墨封装然后应用到基材上的方法是每个公司与其他公司的区别。这些过程非常复杂，是被严密保护的行业机密。尽管如此，制造电子纸比LCD简单，成本也低。

# 历史

- 1970年代美国施乐公司的PARC研究员Nick Sheridon发明了第一张电子纸，叫做Gyricon，它由直径在75到106微米之间的聚乙烯球体组成。每个球体都是两面粒子，一面是带负电的黑色塑料，另一面是带正电的白色塑料（因此每个球头都是偶极子），这些球体被嵌入一个透明的硅胶片中，而且每个球体都悬浮在一个油泡中，这样它就能够自由地旋转。施加在每一对电极上的电压的极性决定了白色还是黑色的那面正面朝上，从而使像素呈现出白色或黑色的外观。
- 1970 年代，日本松下公司首先发表了**电泳显示**技术 。与此同时，施乐公司当时也在研究电泳显示技术。然而最初研究出的普通电泳由于存在显示寿命短、不稳定、彩色化困难、造价高等诸多缺点，松下公司和施乐公司的实验曾一度中断，搁置了 20 年，电子纸技术只在实验室里，停留在理论阶段。
- 1990年代，麻省理工学院的一个本科生团队构想了基于微封装电泳显示的**电子墨水（electronic ink）**，并制作出了原型
- 1997年，麻省理工学院研究电子纸技术的本科生J.D. Albert和Barrett Comiskey以及教授Joseph Jacobson、Jeremy Rubin和Russ Wilcox共同创立了E Ink公司，致力于将该技术商业化。
- 1999 年，E Ink与Philips Components公司建立了合作伙伴关系，共同开发和推广这项技术（E Ink负责电子墨水材料，Philips负责电子驱动和模块）。5月，E Ink 公司推出用于户外广告的电子纸 Immedia
- 2000 年 11 月，E-Ink 公司和朗讯科技公司（Lucent Technologies）正式宣布已开发成功第一张可卷曲的电子纸和电子墨。
- 2002 年 3 月召开的东京的国际书展上，出现了第一张彩色电子纸。
- 2004 年，**由E Ink和Philips提供技术支持**，Sony生产并发布了世界上第一台实际商用的电子墨水屏阅读器：Sony Librie EBR 1000。
- 2005 年，Philips将电子纸业务及其相关专利出售给其主要业务合作伙伴之一的台湾新竹制造商**Prime View International（PVI，元太科技）**。
- 2007 年，**由E Ink和PVI提供技术支持**，亚马逊发布第一代 Kindle 阅读器，引爆电子书市场。**因为 Kindle 的热卖，「电子墨水屏」这个词，终于被大众熟知。**E Ink 公司在 1997 年就发明了 E Ink 技术，等到它最终被市场认可，过了整整十年。在这十年里，E Ink 公司一直都处于亏损状态。
- 在美国次贷危机冲击下，由于承受不住巨大的亏损，E Ink于2008年6月1日宣布与 PVI 达成以2.15亿美元被收购的初步协议，经过谈判，最终金额达到4.5亿美元。
- 2009年12月24日，E Ink正式被PVI收购。收购完成后，PVI更名为E Ink Holdings Inc
- 2012年12月，E Ink Holdings Inc 收购了竞争对手电泳显示公司SiPix

至此，**E Ink Holdings Inc 成为世界上唯一同时具备电子纸技术和量产能力的公司**。

# 电子墨水

## 概述

E Ink（electronic ink，电子墨水）是E Ink公司商业化的电子纸显示技术品牌。1997年，麻省理工学院研究电子纸技术的本科生J.D. Albert和Barrett Comiskey以及教授Joseph Jacobson、Jeremy Rubin和Russ Wilcox共同创立了E Ink公司，致力于将电子墨水技术商业化。



在E Ink公司，Comiskey领导了E Ink第一代电子墨水的开发工作，而Albert则开发了用于大批量生产电子墨水显示器的制造方法，Wilcox担任多种业务角色，并从2004年到2009年担任首席执行官（CEO）。



电子墨水是目前唯一商业化的电子纸技术。**电子墨水被制成薄膜，然后集成到电子显示器中**，使其在手机、手表、杂志、可穿戴设备和电子阅读器等方面实现新颖的应用。

> [!TIP]
>
> 电子墨水由数百万个微小的微胶囊组成，直径约为人类头发的直径。每个微胶囊都含有悬浮在透明液体中的带正电的白色颗粒和带负电的黑色颗粒。当施加正或负电场时，相应的粒子移动到微胶囊的顶部，这使得那个点表面呈现白色或黑色。
>
> 由于电子墨水是一种液态材料，所以被形象地称为电子墨「水」。



E Ink技术方案

<img src="https://raw.githubusercontent.com/ALmnoo/image-service/main/2560px-Electronic_paper_(Side_view_of_Electrophoretic_display)_in_svg.svg.webp" alt="undefined" style="zoom: 25%;" />

| 图例 |                           项                            |
| :--: | :-----------------------------------------------------: |
|  1   |                 **上层（Upper layer）**                 |
|  2   |      **透明电极层（Transparent electrode layer）**      |
|  3   |       透明的微胶囊（Transparent micro-capsules）        |
|  4   |  带正电的白色颜料（Positively charged white pigments）  |
|  5   | 带负电荷的黑色颜料（Negatively charged black pigments） |
|  6   |               透明油份（Transparent oil）               |
|  7   |           电极像素层（Electrode pixel layer）           |
|  8   |        **底部支撑层（Bottom supporting layer）**        |
|  9   |                       光（Light）                       |
|  10  |                      白色（White）                      |
|  11  |                      黑色（Black）                      |



[Kindle Paperwhite结构图](https://archive.nytimes.com/www.nytimes.com/interactive/2012/12/26/technology/light-reading.html?_r=2&ref=personaltech)

<img src="https://raw.githubusercontent.com/ALmnoo/image-service/main/How%20the%20Kindle%20Paperwhite%20Works.webp" alt="How the Kindle Paperwhite Works" style="zoom: 33%;" />

<img src="https://raw.githubusercontent.com/ALmnoo/image-service/main/how-the-kindle-paperwhite-works.webp" alt="how-the-kindle-paperwhite-works" style="zoom: 33%;" />

![img](https://raw.githubusercontent.com/ALmnoo/image-service/main/Kindle-PaperWhite-Screen-Tech-Hero.webp)

## 版本或型号

电子墨水有灰色和彩色。



E Ink **黑白灰阶**品牌Carta

- 2013：**Carta**

  > **E Ink Carta**于2013年1月在国际消费电子展上发布在一块具有768 × 1024分辨率的6英寸显示屏上，像素密度为212 ppi

- 2014：**Carta HD**

  > **E Ink Carta HD**在6英寸屏幕上具有1080 × 1440的分辨率，像素密度为300 ppi。

- 2021：**Carta 1200**

- 2023：**Carta 1300**

**最初的E Ink Carta显示被重新命名为Carta 1000、1100**。



Carta 1100 和 1200改进了反应时间和显示对比度，Carta 1250中再次改进了响应时间和对比度。

- Carta 1100/1200（较Carta 1000反应速度提升**20%**，对比度提升**15%**）

- Carta 1300（较Carta 1000反应速度提升**27%**，对比度提升**20%**）

E Ink Carta 1000、1100、1200 均支持REAGL™图像刷新技术，几乎无需全面刷新画面，通过更顺畅的翻页，阅读者能拥有更专注的阅读过程。

> 参考：[E Ink 元太科技 电子墨水品牌](https://cn.eink.com/brand?bookmark=Carta)

> [!IMPORTANT]
>
> **Carta迭代的提升并不大**
>
> 如果以数值大小衡量反应速度和对比度，假设Carta1000：反应速度100、对比度100，那么
>
> - Carta 1100/1200：反应速度120、对比度115
> - Carta 1300：反应速度127、对比度120
>
> Carta1300相比Carta 1100/1200，提升甚至微乎其微：反应速度提升约**5.8**%、对比度提升约**4.3**%

> [!TIP]
>
> 对比度（**contrast ratio**，**CR** ) 是显示系统的一个属性，定义为系统能够产生的最亮色调（白色）与最暗色调（黑色）的亮度之比，高对比度是任何显示器都需要的。对比度越高，从黑到白的渐变层次就越多，从而色彩表现越丰富。一般来说对比度越高，图案越清晰醒目，色彩也越鲜明艳丽；而对比度小，则会让整个画面都灰蒙蒙的。

## E Ink卖什么？

E Ink向希望将反射显示集成到其应用中的设备制造商**销售显示模块**。E Ink目前有两个可用的显示平台

- 分段显示（Segmented display）：使用可打开或关闭的预定义段来显示。这类似于典型的带有数字或字母数字显示的计算器——显示由像素数组或预定义形状的集合组成。
- 矩阵显示（Matrix display）：用于显示多种不同形式的文本和图像。显示器由大量像素组成，单个像素由 TFT 阵列控制，类似于典型的计算机显示器或电视屏幕。



E Ink既销售**完整的显示模块**也销售**显示膜（E Ink膜）**，这两种都用于矩阵显示

1. 您可以订购一个**具有TFT（柔性或玻璃）的完整组装的显示模块**。**显示模块由TFT（thin film transistor, 薄膜晶体管）、电子墨水薄膜及保护膜所构成**。

2. 你也可以只订购**切割的电子墨水薄膜部分**，那么你将不得不**层压到某种形式的电子背板「如TFT」中来控制电子墨水**。

## E Ink矩阵显示屏可以有多大/多小？

电子墨水矩阵显示器的大小和形状完全取决于电子墨水薄膜层被压到什么大小的电子背板上。显示器可以非常小，也可以非常大。E Ink有标准的显示模块。几乎可以制作任何尺寸和形状，只取决于你希望的体积。

## E Ink 矩阵显示器消耗多少电量？

电子墨水矩阵显示器是双稳态的，这意味着它们只在显示被更新时消耗电量，更新后的图像不需要任何电源来维护。更新过程所需的功率取决于显示器的大小，但以微瓦为数量级。

## 参考

- [E Ink 元太科技 电子墨水技术 FAQ](https://cn.eink.com/tech/detail/FAQ)

# 知名的电子墨水屏阅读器品牌

全球

- 亚马逊Kindle



国内

- 掌阅iReader
- 文石
- 汉王

# 选购墨水屏阅读器的核心参数

## 概述

作为一款电子产品，电子墨水屏阅读器的核心参数自然包括：CPU、内存、存储、显示器等。但因为电子墨水屏阅读器的核心任务是阅读，所以对性能的要求不是很高（当然越高越好），反而这块屏幕的显示效果更为重要。



阅读器核心参数

- 显示屏
- 操作系统易用性与维护性
- 续航
- ...

> [!IMPORTANT]
>
> **软件非常重要，决定了硬件优势是否被充分地发挥**

## 显示屏

### 电子墨水薄膜

Carta版本越新越好，但Carta迭代的提升并不大，不必一味追求最新

### 分辨率

300ppi及更高为佳

### 屏幕尺寸

- 6寸更为便携
- 6寸以上通常不太能随身携带

### 屏幕形态

主要分为：**凹陷**与**平面**



凹陷屏幕前盖只有边框，而平面屏幕前盖上还有齐平的盖板（通常是玻璃或塑料），从而做到的平面。

- **显示效果**：由于平面屏幕与凹陷屏幕相比，在显示模块之上多了一层盖板，因此凹陷屏幕在显示上更有在纸上的感觉，**追求绝对的纸质显示效果选择凹陷屏幕**

- **保护性**：由于平面屏幕与凹陷屏幕相比，在显示模块之上多了一层盖板，因此平面屏幕对显示模块的保护性更强

## 前盖颜色

强烈推荐**黑色**。黑色最吸光，白色最反光，因此显示屏与黑色前盖的对比度较其它颜色更高，使得视觉上显示屏的颜色更白。

# 参考

- [Electronic paper](https://en.wikipedia.org/wiki/Electronic_paper)
- [E Ink](https://en.wikipedia.org/wiki/E_Ink)
- [重度使用这款墨水屏手机之后，谈谈我对电子纸的理解和预测](https://sspai.com/post/65051)

# ——————

# Kindle

## 产品发布时间线

[Kindle 墨水屏阅读器历史](https://bookfere.com/post/2.html)

## 海淘Kindle

https://uuzi.net/how-to-buy-kindle-books-from-amazon-usa/

## 快速入门

### 账户

亚马逊于2023年6月30日在中国停止Kindle电子书店的运营，此次调整细节

- **2023年6月30日**：Kindle电子书店运营截止日期
- **2024年6月30日**：Kindle电子书下载功能关闭日期

区域设置为中国大陆的账号将无法使用亚马逊提供的网络内容服务，因此你需要注册一个其它区域的亚马逊账号来在Kindle上继续使用亚马逊提供的网络内容服务。不同区域的亚马逊站点有所区别

- 美国亚马逊、中国亚马逊、日本亚马逊账号是相互独立的，所以 Kindle 相关的内容服务也是独立的，
- 而美国亚马逊、英国亚马逊、法国亚马逊、德国亚马逊等，账号是互通的



你可以根据自己的需要注册特定区域的亚马逊账户

> [!TIP]
>
> 推荐注册美国亚马逊账户：https://www.amazon.com

### Kindle支持的内容格式

- **原生支持**：Kindle Format 8 (AZW3)、Kindle (AZW)、TXT、PDF、无保护的MOBI、PRC
- **通过转换支持**：PDF、DOCX、DOC、HTML、EPUB、TXT、RTF、JPEG、GIF、PNG、BMP



MOBI、AZW、AZW3、KFX都是亚马逊的私有格式

- **MOBI、AZW格式**：可以简单地理解为，MOBI 是一种比较老的格式，而 AZW 只是 MOBI 的另一种形式而已，相当于支持DRM版权保护的MOBI。

- **AZW3（即 Kindle Format 8，简称 KF8）**：它是随着 2011 年亚马逊推出 Kindle Fire 平板电脑时一同推出的，它改善了 MOBI 对于复杂排版支持的缺陷，单纯从读者的角度来讲，是不输于 EPUB 格式的。

  > 目前从亚马逊购买的书，大部分已经是 AZW3 格式了，而以前主流的 MOBI 格式则越来越少，在更新的 KFX 格式出现之前，一度成为 Kindle 电子书的主流格式。

- **KFX（即 Kindle Format 10，简称 KF10）格式是 AZW3 格式的继任者**，该格式是随着 [Kindle Paperwhite 3](https://bookfere.com/post/2.html#k7_3) 推出的一种新的 Kindle 电子书格式，包含很多新的特性，比如增强的排版引擎、具有更高压缩率的新图片格式 JXR、快速翻页等。

  > 这种格式有一个显著的特点：书中的图片会被分离出去，也就是说你无法在 Kindle 设备中得到一个完整的电子书副本。
  >
  > 另外 KFX 不像 AZW3 那样容易去除 DRM 保护，因为它使用了完全不同的加密方式。

### 传书方式

#### 1. 亚马逊Send to Kindle服务

前置工作

1. 在Kindle上登录你的亚马逊账户就可以使用亚马逊**个人文档服务**了

   > 在亚马逊网站的账户下的Devices中能够看到登录了该账号的Kindle，设备卡片中会显示关联该设备的邮箱，邮箱的域名部分为 **@kindle.com**（如果发现显示仍然是 @kindle.cn，将亚马逊站点的语言切换到英文即可）

2. 在亚马逊网站的账户下的“Preference”（偏好设置）中将你的发件邮箱添加为认可的发件电子邮箱



[Send to Kindle](https://www.amazon.com/sendtokindle)有多种形式，支持的文件类型PDF, DOC, DOCX, TXT, RTF, HTM, HTML, PNG, GIF, JPG, JPEG, BMP, **EPUB**

- Web
  - 支持的最大文件大小：200MB
- Email
  - 支持的最大文件大小：50MB
- 应用（iOS、Android、macOS、Windows）

> [!TIP]
>
> Send to Kindle服务的工作原理就是**上传文件至亚马逊账户中（亚马逊称之为内容）**，然后关联同一账户的Kindle联网后就可以从账户中同步文档到Kindle本地的图书馆中。

#### 2. USB连接传输

连接数据线拷贝电子书很简单，只需要通过 USB 将[Kindle 支持的电子书文件](https://bookfere.com/post/367.html)拷贝到 **documents** 文件夹中即可。



> [!IMPORTANT]
>
> **由于不通过亚马逊服务传输文档，因此USB连接传输的方式只支持Kindle原生支持的文档格式，只有Kindle原生支持的文档才会在Kindle图书馆中显示**

> [!IMPORTANT]
>
> 注意
>
> - 在 Kindle 中直接阅读大尺寸的 PDF 格式体验较差，你可以通过横屏阅读
> - 在 Kindle 中阅读 TXT 格式可能会出现缺字的情况，建议[用 Calibre 转换格式](https://bookfere.com/post/10.html)后再阅读。
>
> - 如果你的 Kindle 已经成功[越狱](https://bookfere.com/post/406.html)，还可以通过安装插件 [KOReader](https://bookfere.com/post/39.html) 以实现在 Kindle 直接阅读 EPUB 等 Kindle 原生不支持的格式，这款插件还能对 PDF 进行重排，提升阅读体验。

#### 方式选择

可以简单地认为

- 通过Send to Kindle服务将文档上传至亚马逊云端管理，因而亚马逊个人文档服务能够将有限的、不被Kindle原生支持的文档格式转换为Kindle支持的文档格式，能够实现多设备同步进度、标注等
- 而USB连接传输的文档为本地文件，未经过任何亚马逊服务的处理。

## 去广告

Kindle分为广告版（稍低价格）和无广告版（稍高价格）。广告版将在设备处于睡眠模式时显示广告作为屏幕保护程序，并在你的主屏幕上标记为“赞助”。

### 方式一

1. 在你的账户中添加一个中国地址，然后在“Content & Devices”（内容和设备）的“Preferences”（偏好设置）标签页中的“Country/Region Settings”（区域设置）更改为这个中国地址。

2. 重置你的Kindle

3. 设置->屏幕和亮度，打开在锁屏上显示封面

4. 在你的账户中添加一个美国地址，重新更改为这个美国地址

   > [!IMPORTANT]
   >
   > 如果不改回美国地址，那么
   >
   > - 同步到最远阅读页将失败
   > - 下载文档到本地时可能会卡进度

5. 重启你的Kindle

### 方式二

找客服去除

## 禁用索引

kindle上的图书索引是指将设备上每本书的字词注册到数据库中，供检索功能使用的过程。如果你打算在你的书籍中搜索词（无论是从主屏幕搜索框还是从书中）你需要它。这个过程消耗相当多的CPU和电池。每次你加载新书到设备上时都会发生，并且每6个月刷新一次。如果你一次放很多书，你可以期待两种不同的情况

- 具有旧版本的固件，设备可能会冻结或变得难以使用，直到索引完成
- 具有更新版本的固件，索引过程更温和，但需要更长的时间

在这两种情况下，你的电池电量都会比平时下降得更快。此外，索引数据需要一些空间（例如100本书可能需要10MB）。



在将大量的书加载到kindle后，有的人把它插上电源，直到索引完成。这样，软件就可以继续索引，而不必试图节省能源（对于较新的版本）。我想如果你有很多书的话，这可能需要几天的时间。你可以检查有多少书待索引：搜索一个不能被找不到的词，比如“tttt”，然后在书中查找结果。它会告诉你是否有些书还需要被索引。



无论什么原因，你可能想跳过这一步，使用你的电子阅读器，而不会因为这个功能失去能源。或者你根本不关心这个搜索功能，只想永远禁用它。

- 简单的解决方案是将您的设备插入计算机上，将目录“system/Search Indexes”删除（您可以猜到这个目录包含索引数据），然后创建一个名为Search Indexes的空文件，这一步很重要，如果您只是删除这个文件夹，它将被重新创建。然而，这个过程只是使得索引器缺少必要条件而快速结束，索引器本身并没有被停止，在下一个合适的时机，索引任务仍会进行，但相比于创建索引要更节省能源。

  > [!TIP]
  >
  > 参考
  >
  > - [Disable Kindle Indexing Without Jailbreaking](https://www.mobileread.com/forums/showthread.php?t=279955)

- 如果你的Kindle越狱了，编辑文件`/etc/upstart/framework`，找到`DENABLE_SEARCH_INDEXING_THREAD=true`编辑为`DENABLE_SEARCH_INDEXING_THREAD=false`，然后重新启动你的Kindle。**但这似乎并没有停止索引器，索引仍在进行，你能够看到Search Indexes目录中的文件仍然在增加**，这似乎是控制是否启用线程进行索引搜索，启用应该会使搜索速度加快。

  > [!TIP]
  >
  > 参考
  >
  > - [Disable Kindle Indexing](https://www.mobileread.com/forums/showthread.php?t=220735)



正确停止索引器的前提是知道它是如何工作的，找到`/opt/amazon/ebook/lib/kafindexer.jar`文件，解压后找到其中的`com/kindle/indexer/bundle/IndexerThread.class`文件，关键代码是

- `static`块
- 静态方法`initializeMasterIndex`
- 实例方法`allowedToStartIndexing`，不开始索引过程的情况有
  - 没有足够的电量：不在充电而且电量低（少于20%）
  - 电池温度不合适：电池温度大于122度
  - 索引过程正在进行
  - 堆空间太低
  - 可用内存太低
  - 正在播放音频
  - 用户存储不可用
  - **索引器阻止应用程序（阅读器、期刊、发现、商店）正在使用而且不处于屏保**
  - 索引终止（始终为false）
  - 没有足够的空间

但由于这只是索引器线程代码，尚不知晓创建该线程的逻辑因而无法确定如何禁用索引器。



结论

- 当正在阅读时不会开始索引过程，因而你可以相信索引器至少不会在你阅读时使用额外的电量
- 出于一些原因，你可能希望索引过程在任何时候都不要开始，在知晓彻底禁用索引器线程之前，将目录“system/Search Indexes”删除，然后创建一个同名的“Search Indexes”空文件使索引器线程缺少执行任务的必要条件而快速结束是一个不错的选择。

> [!TIP]
>
> 参考
>
> - [Disable search indexes by modifying jar](https://www.mobileread.com/forums/showthread.php?t=283797)

## 搜索框命令

Kindle主页的搜索框可以执行一些白名单命令，命令列表文件可以在`/usr/share/webkit-1.0/pillow/debug_cmds.json`，以下是Kindle (11th Generation) - 2024 Release 的命令清单

```json
{
    ";log" : "/usr/bin/logThis.sh",
    ";enter_demo" : "/usr/bin/createDemoModeFlagFile.sh",
    ";exit_demo" : "/usr/bin/deleteDemoModeFlagFile.sh",
    ";vfd" : "/usr/bin/verifyDemo.sh",
    ";dm" : "/usr/bin/dm.sh",
    ";311" : "/usr/bin/311.sh",
    ";411" : "/usr/bin/411.sh",
    ";611" : "/usr/bin/611.sh",
    ";711" : "/usr/bin/711.sh",
    ";st" : "/usr/bin/dateTime.sh",
    ";shpm" : "/usr/sbin/shipping_mode",
    ";un" : "/usr/local/bin/usbnetwork.sh start",
    ";uns" : "/usr/local/bin/usbnetwork.sh stop",
    ";debugOn" : "/usr/bin/debugOn.sh",
    ";debugOff" : "/usr/bin/debugOff.sh",
    ";bsalogoff" : "/usr/bin/bsaLogOff.sh",
    ";bsalogon" : "/usr/bin/bsaLogOn.sh",
    ";wmtlog" : "/usr/bin/wmtLog.sh",
    ";uzb" : "/usr/bin/enableUSBInDemo.sh",
    ";dsts" : "/usr/bin/startSettingsInDemo.sh",
    ";updateCamp" : "/usr/bin/updateCamp.sh",
    ";wwreset" : "/usr/bin/wwReset.sh",
    ";demo" : "/usr/bin/demoConfig.sh",
    ";duzb" : "/usr/bin/disableUSBInDemo.sh",
    ";chkup" : "/usr/bin/checkUpdate.sh",
    ";ledon" : "/usr/bin/turnOnLed.sh"
}
```

注意`/usr/local/bin/`在设备上不存在，所有很多命令没有作用。

> [!TIP]
>
> 参考
>
> - [Kindle Touch Hacking](https://wiki.mobileread.com/wiki/Kindle_Touch_Hacking#Search_Bar_Shortcuts)

# Kindle越狱

## 概述

越狱（jailbreak）：对一项技术进行更改以便能够以生产它的公司或个人所不期望的方式使用它的行为。



越狱Kindle

- 作为开发，这使您可以

  - 创建系统修改或扩展，以进一步扩展设备的功能。

  - 在 Kindle 上运行开发的自定义自制程序

- 作为用户，这使您可以
  - 自定义屏保
  - 自定义不被固件支持的字体
  - 运行例如App、游戏或其它的自制程序
  - 降级固件

> [!Caution]
>
> 在你越狱你的Kindle之前，请注意越狱的风险，包括但不限于
>
> - 可能导致Kindle的保修失效
> - 使设备变砖（永久损坏）
> - 安全风险
>
> 越狱风险自负。如果你不知道或者不确定自己在做什么，就不要这么做。



在越狱前，有一些昵称是你需要知道的

- Kindle昵称，大体来说

  - 没有触控功能的基础版昵称以K为前缀，K即Kindle

  - 有触控功能的基础版昵称以**KT**为前缀，KT即Kindle Touch

  - Paperwhite系列以PW为前缀，PW即Paperwhite

  > [!TIP]
  >
  > 具体参考[所有Kindle型号](https://kindlemodding.org/jailbreaking/kindle-models.html)

- FW：Firmware，即固件

- HF：指代版本5.16.3及之后的固件

  > [!TIP]
  >
  > HF（hard float），例如armhf是arm hard float，固件5.16.3之前使用的是armel ABI。
  >
  > 详情参见https://www.mobileread.com/forums/showthread.php?t=251143&page=11

越狱过程：https://kindlemodding.org/jailbreaking/WinterBreak/

> [!TIP]
>
> macOS可以在访达中使用快捷键`command` + `shift` + `.`切换隐藏文件的显示

## 越狱后

一旦你越狱了你的Kindle，还有一些非常重要的步骤需要执行

- [安装hotfix](https://kindlemodding.org/jailbreaking/post-jailbreak/setting-up-a-hotfix/)：[hotfix](https://github.com/KindleModding/Hotfix)可以让你的Kindle在更新后保持越狱

  > [!NOTE]
  >
  > 每次 OTA 更新后，您都需要运行修补程序手册

- [安装KUAL和MRPI](https://kindlemodding.org/jailbreaking/post-jailbreak/installing-kual-mrpi/)：一旦hotfix运行完毕，您可以安装KUAL和MRPI，你需要安装**KUAL（Kindle Unified Application Launcher，Kindle统一应用程序启动器）**和**MRPI（MobileRead Package Installer，MobileRead包安装器）**才能在你的Kindle上运行自制程序。

  > [!TIP]
  >
  > - 顾名思义，[KUAL](https://www.mobileread.com/forums/showthread.php?t=203326)是一个应用启动器，任何人都可以通过扩展向插入其中提供新的按钮和菜单。这些按钮几乎可以运行任何东西，并且后端足够强大，足以使菜单动态，允许开发人员使用KUAL作为他们东西的一个配置UI！但基本原则是：点击按钮运行。许多hack都附带了一个KUAL扩展，这就是您经常会看到KUAL被列为必需的依赖项的原因。
  > - [MPRI](https://www.mobileread.com/forums/showthread.php?t=251143)是一个KUAL扩展，它将在Helper菜单中插入一个单独的Install MR Packages按钮。它以更新包（.bin）的形式替代旧的Update Your Kindle来安装MR上提供的各种软件包，它不会强制您完全重新启动，简而言之，它明显更有效率，它支持所有能够运行KUAL的设备。

  > [!IMPORTANT]
  >
  > 有两种KUAL文件：**KUAL**、**KUAL (coplate)** ，对于**FW >= 5.9.x**的设备，在这些设备上，您需要使用 @coplate 的修补版本而不是原始的Booklet版本
  >
  > > [!WARNING]
  > >
  > > 如果你看到一个“Application Error”对话框，你可以毫不担心地关闭它——这是一些现代kindle的正常行为

  > [!IMPORTANT]
  >
  > MPRI目前最新更新是2023-11-05，因此如果FW >= 5.16.3，你需要从[这里](https://fw.notmarek.com/khf/)下载修改支持HF的版本

- [禁止自动更新](https://kindlemodding.org/jailbreaking/post-jailbreak/disable-ota.html)：Kindle在连接WiFi时会自动更新（尽管有hotfix）这通常会导致越狱系统不稳定，或者直接移除越狱。

## 有用的软件包

- [KOReader](https://github.com/koreader/koreader)：KOReader是一个电子墨水设备的文档查看器。支持的文件格式包括EPUB, PDF, DjVu, XPS, CBT, CBZ, FB2, PDB, TXT, HTML, RTF, CHM, DOC, MOBI和 ZIP文件。它可用于Kindle、Kobo、PocketBook、Android和桌面Linux。
- [KUAL+](https://www.mobileread.com/forums/showpost.php?p=2591705&postcount=1014)：扩展KUAL菜单，为KUAL本身提供了更多配置选项。
- [coversetter](https://www.mobileread.com/forums/showpost.php?p=4222466&postcount=15)：为您的kual和kol设置漂亮的封面
- [Helper](https://www.mobileread.com/forums/showthread.php?t=225030)：提供了一些可执行简单命令的快捷菜单
- [BatteryStatus](https://www.mobileread.com/forums/showpost.php?p=2636886&postcount=52)：查看电池状态



参考

- [Snapshots of NiLuJe’s hacks](http://www.mobileread.com/forums/showthread.php?t=225030)
- [A helpful list of Extensions for KUAL](http://www.mobileread.com/forums/showthread.php?t=205064)

## 开启Kindle 2024基础款的翻页动画

1. 解密`/etc/deviceConfig.conf`

   ```bash
   devcap-encrypt -i /etc/deviceConfig.conf /tmp/deviceConfigDecrypted.conf
   ```

2. 修改解密后的文件，把`[ri7]`组的`swipeMode.available`配置从`false`改为`true`

3. 将修改后的文件重新加密，然后替换原文件

   ```bash
   devcap-encrypt -i /tmp/deviceConfigDecrypted.conf /tmp/deviceConfigNew.conf
   cp /tmp/deviceConfigNew.conf /etc/deviceConfig.conf
   ```

4. 重启Kindle

5. 打开一本文字书，启用Aa设置->更多->翻页动画效果

> [!TIP]
>
> - [KV Kindle Voyage - disable touch screen in native way](https://www.mobileread.com/forums/showthread.php?t=343353)

## Kindle源代码

- [Source Code Notice for Kindle E-Readers and Fire Tablets](https://www.amazon.com/gp/help/customer/display.html?ie=UTF8&nodeId=200203720)

# ——————

# KOReader

## 概述

KOReader是一个适用于E-ink设备的文档查看器。支持的文件格式包括**EPUB**, PDF, DjVu, XPS, CBT, CBZ, FB2, PDB, **TXT**, **HTML**, RTF, CHM, **DOC**, **MOBI**和 ZIP文件。它可用于Kindle、Kobo、PocketBook、Android和桌面Linux。“KOReader”这个名字代表 **Kindle/Kobo Open Reader**，KOReader 最初就是为这些设备编写的。



KOReader有2个主要界面：**阅读屏幕**和**文件浏览器**，大部分设置需要打开书后才能进行设置。

## 手动更新

复制 **koreader-kindle\*.zip** 或 **koreader-kindle*.tar.gz** 文件到 kindle 根目录下（即`/mnt/us`），然后在Kindle上，KUAL->KOReader->Tools->Update KOReader。

> [!IMPORTANT]
>
> 左下角会一直显示`Try to update KOReader...`信息而且似乎什么事也没有发生，但是等待一会重新打开KOReader，如果更新成功，那么你将查看到更新后的版本。

## 字体

`koreader/frontend/fontlist.lua`中`FontList:_readList`方法是读取字体的逻辑，以下是kindle字体黑名单，值为true的kindle字体将不会展示在KOReader的字体列表中。如果你想使用其中的字体，将相应文件放入`koreader/fonts`下，并将相应值修改成false

```lua
--[[
这些非 non-LGC Kindle 系统字体 fonts 无法通过CRe的愚蠢的头检查.
也应用到有不同family名称用于不同风格的一系列LGC字体...
(这些实际上是通过stock系统中的FontConfig "fixed"的)
--]]
local kindle_fonts_blacklist = {
    ["DiwanMuna-Bold.ttf"] = true,
    ["DiwanMuna-Regular.ttf"] = true,
    ["HYGothicBold.ttf"] = true,
    ["HYGothicMedium.ttf"] = true,
    ["HYMyeongJoBold.ttf"] = true,
    ["HYMyeongJoMedium.ttf"] = true,
    ["KindleBlackboxBoldItalic.ttf"] = true,
    ["KindleBlackboxBold.ttf"] = true,
    ["KindleBlackboxItalic.ttf"] = true,
    ["KindleBlackboxRegular.ttf"] = true,
    ["Kindle_MonospacedSymbol.ttf"] = true,
    ["Kindle_Symbol.ttf"] = true,
    ["MTChineseSurrogates.ttf"] = true,
    ["MYingHeiTBold.ttf"] = true,
    ["MYingHeiTMedium.ttf"] = true,
    ["NotoNaskhArabicUI-Bold.ttf"] = true,
    ["NotoNaskhArabicUI-Regular.ttf"] = true,
    ["NotoNaskh-Bold.ttf"] = true,
    ["NotoNaskh-Regular.ttf"] = true,
    ["NotoSansDevanagari-Regular.ttf"] = true,
    ["NotoSansBengali-Regular.ttf"] = true,
    ["NotoSansGujarati-Regular.ttf"] = true,
    ["NotoSansKannada-Regular.ttf"] = true,
    ["NotoSansMalayalam-Regular.ttf"] = true,
    ["NotoSansTamil-Regular.ttf"] = true,
    ["NotoSansTelugu-Regular.ttf"] = true,
    ["SakkalKitab-Bold.ttf"] = true,
    ["SakkalKitab-Regular.ttf"] = true,
    ["SongTBold.ttf"] = true,
    ["SongTMedium.ttf"] = true,
    ["STHeitiBold.ttf"] = true,
    ["STHeitiMedium.ttf"] = true,
    ["STSongBold.ttf"] = true,
    ["STSongMedium.ttf"] = true,
    ["TBGothicBold_213.ttf"] = true,
    ["TBGothicMed_213.ttf"] = true,
    ["TBMinchoBold_213.ttf"] = true,
    ["TBMinchoMedium_213.ttf"] = true,
    ["STKaiMedium.ttf"] = true,
    ["Amazon-Ember-Bold.ttf"] = false,
    ["Amazon-Ember-BoldItalic.ttf"] = false,
    ["Amazon-Ember-Heavy.ttf"] = true,
    ["Amazon-Ember-HeavyItalic.ttf"] = true,
    ["Amazon-Ember-Medium.ttf"] = true,
    ["Amazon-Ember-MediumItalic.ttf"] = true,
    ["Amazon-Ember-Regular.ttf"] = false,
    ["Amazon-Ember-RegularItalic.ttf"] = false,
    ["AmazonEmberBold-Bold.ttf"] = true,
    ["AmazonEmberBold-BoldItalic.ttf"] = true,
    ["AmazonEmberBold-Italic.ttf"] = true,
    ["AmazonEmberBold-Regular.ttf"] = true,
    ["Caecilia_LT_65_Medium.ttf"] = false,
    ["Caecilia_LT_66_Medium_Italic.ttf"] = true,
    ["Caecilia_LT_75_Bold.ttf"] = false,
    ["Caecilia_LT_76_Bold_Italic.ttf"] = true,
    ["Caecilia_LT_67_Cond_Medium.ttf"] = true,
    ["Caecilia_LT_68_Cond_Medium_Italic.ttf"] = true,
    ["Caecilia_LT_77_Cond_Bold.ttf"] = true,
    ["Caecilia_LT_78_Cond_Bold_Italic.ttf"] = true,
    ["Futura-Bold.ttf"] = true,
    ["Futura-BoldOblique.ttf"] = true,
    ["Helvetica_LT_65_Medium.ttf"] = false,
    ["Helvetica_LT_66_Medium_Italic.ttf"] = true,
    ["Helvetica_LT_75_Bold.ttf"] = true,
    ["Helvetica_LT_76_Bold_Italic.ttf"] = true,
}
```

- `SongTMedium.ttf`在KOReader中显示名称为`STBShusong`
- `SongTBold.ttf`在KOReader中显示名称为`STBShusong-Bold`

## 翻页动画

KOReader的翻页动画由`koreader/frontend/device/generic/device.lua`中`Deivce`对象的`canDoSwipeAnimation`标志控制，Kindle的`Device`对象位于`koreader/frontend/device/kindle/device.lua`，支持翻页动画的Kindle设备有

- KindlePaperWhite5
- KindlePaperWhite5SE
- KindlePaperWhite6
- KindleBasic4（Kindle Touch 5）
- KindleBasic5（Kindle Touch 6）
- KindleScribe
- KindleColorSoft

启用逻辑在`koreader/frontend/apps/reader/modules/readerview.lua`的`onPageChangeAnimation`方法

```lua
function ReaderView:onPageChangeAnimation(forward)
    if Device:canDoSwipeAnimation() and G_reader_settings:isTrue("swipe_animations") then
        if self.inverse_reading_order then forward = not forward end
        Screen:setSwipeAnimations(true)
        Screen:setSwipeDirection(forward)
    end
end
```



而实际上翻页动画是由MTK驱动程序提供支持的，参考`ffi/framebuffer_mxcfb.lua`的`refresh_mtk`方法

```lua
local ffi = require("ffi")

local C = ffi.C

local function refresh_mtk() 
  -- ...
  if fb.swipe_animations then
    -- The MTK Driver will crash if given a area smaller than the number of steps.
    -- If direction is L/R and w is smaller or if it is U/D and h is smaller
    -- Being as one genneraly will only want animations on a larger area, and I am too
    -- lazy to test for direction, disable animations when w or h is less than steps.
    if w >= fb.update_data.swipe_data.steps and h >= fb.update_data.swipe_data.steps then
      fb.update_data.flags = bor(fb.update_data.flags, C.MTK_EPDC_FLAG_ENABLE_SWIPE)
    end
    fb.swipe_animations = false
  end
  -- ...
end

function framebuffer:_MTK_SetSwipeAnimations(enabled)
  self.swipe_animations = enabled
end

function framebuffer:init() 
  -- ...
  if self.device:isKindle() then
    require("ffi/mxcfb_kindle_h")
    -- ...
    if self.device:isMTK() then
      self.setSwipeAnimations = self._MTK_SetSwipeAnimations
    end

    -- ...
  end
```

> [!NOTE]
>
> FFI库允许在纯Lua代码中调用外部C函数和使用C数据结构。



> [!TIP]
>
> 参考
>
> - [PW5: Page turn animations](https://github.com/koreader/koreader/pull/8974/files#top)
> - [FR: Page turn animation for android](https://github.com/koreader/koreader/issues/10622)

## 常用设置

### 顶部菜单

- 2

  - 样式微调->段落->段间距->✅段间距
  - 字体->✅STBShusong（长按设为默认字体）

- 3

  - 点击与手势 -> 翻页 -> ✅翻页动画

  - 点击与手势 -> 激活菜单 -> ☑️自动显示底部菜单

  - 网络设置 -> SSH服务器 -> ☑️SSH服务器

  - 进度条 -> ✅打开/关闭章节进度条

  - 状态栏 -> 备选状态栏

    - ☑️书籍作者
    - ☑️当前页
    - ☑️总页数
    - ☑️章节标记
    - 电池状态 -> ☑️电池图标

  - 状态栏 -> 状态栏项目

    - ☑️当前时间
    - ☑️章节剩余页数
    - ☑️书籍剩余时间
    - ☑️章节剩余时间
    - ✅亮度等级
    - ✅Wi-Fi状态

  - 状态栏 -> 配置条目

    - 状态栏项目排列 -> 1. 当前页码、2. 当前时间

    - ✅显示所有选定项目

    - ✅隐藏非激活条目

    - 条目分隔符 -> ✅竖条

      

- 4

  - Calibre -> 无线网络设置 -> ☑️启用无线客户端
  - 进度同步 -> 注册/登录

### 底部菜单

# 参考

- [书伴](https://bookfere.com/)